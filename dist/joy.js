!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("joy",[],e):"object"==typeof exports?exports.joy=e():t.joy=e()}(self,(()=>(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{P5Renderer:()=>f,SVGRenderer:()=>y,circle:()=>x,ellipse:()=>j,line:()=>v,map:()=>w,point:()=>m,rectangle:()=>b,repeat:()=>E,rotate:()=>S,scale:()=>A,translate:()=>O});class r{constructor(t,e,r={},n=[],s=[]){this.tag=t,this.attrs=e,this.kwargs=r,this.transform=[],this.children=n,this.repeatChildren=s}clone(t={}){return new r(this.tag,this.attrs,t,[...this.children])}add(t){return this.children.push(t),this}toString(){return`<${this.tag} ${this.attrs}>`}translate({x:t=0,y:e=0}){let r=new c(t,e);return this.transform.push(r),this}rotate({angle:t=0}){let e=new l(t);return this.transform.push(e),this}scale({x:t=1,y:e=1}){let r=new u(t,e);return this.transform.push(r),this}repeat({n:t,transform:e}){let r=this.clone();return Array(t).fill(0).forEach(((t,n)=>{let s,i={};if("function"==typeof e){const t=e(n);t instanceof h||Array.isArray(t)?(s=t,i=this.kwargs):(s=t.transform,i=t.style||{})}else s=e,i=this.kwargs;let o=e instanceof h&&s instanceof h?new d(n+1,s):s;if(Array.isArray(o))for(let t=0;t<o.length;t++){let e=r.clone(i);e.transform.push(o[t]),this.children.push(e)}else{let t=r.clone(i);t.transform=[o],this.children.push(t)}})),this}}class n extends r{constructor(t=0,e=0,r={}){super("point",{x:t,y:e}),this.x=t,this.y=e}equals(t){return t instanceof n&&t.x===this.x&&t.y===this.y}toString(){return`Point(${this.x}, ${this.y})`}}class s extends r{constructor(t=new n(0,0),e=100,r={}){super("circle",{cx:t.x,cy:t.y,r:e},r),this.center=t,this.radius=e}}class i extends r{constructor(t=new n(0,0),e=200,r=100,s={}){super("ellipse",{x:t.x,y:t.y,width:e,height:r,d:50},s),this.center=t,this.width=e,this.height=r}}class o extends r{constructor(t=new n(0,0),e=200,r=100,s={}){super("rect",{x:t.x,y:t.y,width:e,height:r},s),this.center=t,this.width=e,this.height=r}}class a extends r{constructor(t=new n(-100,0),e=new n(100,0),r={}){super("line",{x1:t.x,y1:t.y,x2:e.x,y2:e.y}),this.start=t,this.end=e}}class h{constructor(t,e,r=[]){this.tag=t,this.attrs=e,this.children=r}translate({x:t=0,y:e=0}){let r=new c(t,e);return this.children.push(r),this}rotate({angle:t=0}){let e=new l(t);return this.children.push(e),this}scale({x:t=1,y:e=1}){let r=new u(t,e);return this.children.push(r),this}repeat({n:t,transform:e}){let r=E({n:t,transform:e});return r instanceof h?this.children.push(r):this.children.push(...r),this}}class c extends h{constructor(t=0,e=0){super("translate",{x:t,y:e}),this.x=t,this.y=e}}class l extends h{constructor(t=0){super("rotate",{angle:-t}),this.angle=-t}}class u extends h{constructor(t=1,e=1){super("scale",{x:t,y:e}),this.x=t,this.y=e}}class d extends h{constructor(t,e){let r=[];for(let n=0;n<t-1;n++)r=r.concat([e,...e.children]);super(e.tag,e.attrs,r)}}class p{constructor(t){this.renderer=t}show(t){}showTransform(t){}}class f extends p{constructor(t){super(t),this.renderer=window.self,this.renderer.translate(this.renderer.width/2,this.renderer.height/2),this.renderer.rectMode(this.renderer.CENTER),this.renderer.angleMode(this.renderer.DEGREES),this.renderer.ellipseMode(this.renderer.RADIUS)}debug(t){console.log(t)}show(t){this.renderer.push(),t.transform.forEach((t=>this.showTransform(t)));for(const[e,r]of Object.entries(t.kwargs))this.renderer[e](r);this.renderer[t.tag](...Object.values(t.attrs)),t.children.forEach((t=>this.show(t))),this.renderer.pop()}showTransform(t){this.renderer[t.tag](...Object.values(t.attrs)),t.children.forEach((t=>{this.showTransform(t)}))}printDebug(t){let e="";e+="push()",e+="\n",e+=t.transform.map((t=>this.printTransformDebug(t))).join("\n");for(const[r,n]of Object.entries(t.kwargs))e+=`${r}(${n})\n`;return e+=`${t.tag}(${Object.values(t.attrs).join(", ")})\n`,e+=t.children.map((t=>this.printDebug(t))).join("\n"),e+="pop()\n",e}printTransformDebug(t){let e="";return e+=`${t.tag}(${Object.values(t.attrs).join(", ")})\n`,e+=t.children.map((t=>this.printTransformDebug(t))).join("\n"),e}}class y extends p{constructor(t){super(t),this.namespace="http://www.w3.org/2000/svg",this.renderer=t}show(t){if(t instanceof n)return;const e=this.renderer.createElementNS(this.namespace,"svg");e.setAttribute("xmlns",this.namespace),e.setAttribute("width","100vw"),e.setAttribute("height","100vh"),e.setAttribute("viewBox","-200 -200 400 400");const r=this.getSvgElement(t);r.setAttribute("transform",`${r.getAttribute("transform")}`),e.appendChild(r),document.body.appendChild(e)}getSvgElement(t){const e=this.renderer.createElementNS(this.namespace,t.tag);for(const[r,n]of Object.entries(t.attrs))e.setAttribute(r,n.toString());for(const[r,n]of Object.entries(t.kwargs))e.setAttribute(r,n.toString());let r=t.transform.map((t=>`${t.tag}(${Object.values(t.attrs).join(",")}) ${t.children.map((t=>`${t.tag}(${Object.values(t.attrs).join(",")})`)).join(" ")}`)).join("");if(0!==t.children.length){let n=this.renderer.createElementNS(this.namespace,"g");n.setAttribute("transform",r),n.append(e);let s=t.children.map((t=>this.getSvgElement(t)));return n.append(...s),n}return e.setAttribute("transform",r),e}}function w(t,e,r,n,s,i=!1){const o=n+(t-e)*(s-n)/(r-e);return i?n<s?Math.min(Math.max(o,n),s):Math.min(Math.max(o,s),n):o}var g=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]])}return r};function m(t={}){var{x:e=0,y:r=0}=t,s=g(t,["x","y"]);return new n(e,r,s)}function x(t={}){var{x:e=0,y:r=0,r:i=100}=t,o=g(t,["x","y","r"]);return new s(new n(e,r),i,o)}function b(t={}){var{x:e=0,y:r=0,w:s=200,h:i=100}=t,a=g(t,["x","y","w","h"]);return new o(new n(e,r),s,i,a)}function j(t={}){var{x:e=0,y:r=0,w:s=200,h:o=100}=t,a=g(t,["x","y","w","h"]);return new i(new n(e,r),s,o,a)}function v(t={}){var{x1:e=-100,y1:r=0,x2:s=100,y2:i=0,l:o}=t,h=g(t,["x1","y1","x2","y2","l"]);return void 0!==o?new a(new n(-o/2,0),new n(o/2,0),h):new a(new n(e,r),new n(s,i),h)}function O({x:t=0,y:e=0}={x:0,y:0}){return new c(t,e)}function S({angle:t=0}={angle:0}){return new l(t)}function A({x:t=1,y:e=1}={x:1,y:1}){return new u(t,e)}function E({n:t,transform:e}){return Array(t).fill(0).map(((t,r)=>{let n;return n="function"==typeof e?e(r):e,e instanceof h?new d(r+1,n):n}))}return e})()));