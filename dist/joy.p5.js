!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("joyP5",[],e):"object"==typeof exports?exports.joyP5=e():t.joyP5=e()}(self,(()=>(()=>{"use strict";var t={d:(e,r)=>{for(var s in r)t.o(r,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:r[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{Joy:()=>y,P5Renderer:()=>g,SVGRenderer:()=>x,joy:()=>m,map:()=>p});class r{constructor(t,e,r={},s=[]){this.tag=t,this.attrs=e,this.kwargs=r,this.transform=[],this.children=s}clone(t={}){return new r(this.tag,this.attrs,t,[...this.children])}add(t){return this.children.push(t),this}toString(){return`<${this.tag} ${this.attrs}>`}translate({x:t=0,y:e=0}){let r=new c(t,e);return this.transform.push(r),this}rotate({angle:t=0}){let e=new l(t);return this.transform.push(e),this}scale({x:t=1,y:e=1}){let r=new u(t,e);return this.transform.push(r),this}repeat({n:t,transform:e}){let r=this.clone();return Array(t).fill(0).forEach(((t,s)=>{let n,i={};if("function"==typeof e){const t=e(s);t instanceof h?(n=t,i=this.kwargs):(n=t.transform,i=t.style||{})}else n=e,i=this.kwargs;if(e instanceof h&&0==s)return;let o=e instanceof h?new d(s-1,n):n,a=r.clone(i);a.transform.push(o),this.children.push(a)})),this}}class s extends r{constructor(t=0,e=0,r={}){super("point",{x:t,y:e}),this.x=t,this.y=e}equals(t){return t instanceof s&&t.x===this.x&&t.y===this.y}toString(){return`Point(${this.x}, ${this.y})`}}class n extends r{constructor(t=new s(0,0),e=100,r={}){super("circle",{cx:t.x,cy:t.y,d:2*e},r),this.center=t,this.radius=e}}class i extends r{constructor(t=new s(0,0),e=200,r=100,n={}){super("ellipse",{x:t.x,y:t.y,width:e,height:r,d:50},n),this.center=t,this.width=e,this.height=r}}class o extends r{constructor(t=new s(0,0),e=200,r=100,n={}){super("rect",{x:t.x,y:t.y,width:e,height:r},n),this.center=t,this.width=e,this.height=r}}class a extends r{constructor(t=new s(-100,0),e=new s(100,0),r={}){super("line",{x1:t.x,y1:t.y,x2:e.x,y2:e.y}),this.start=t,this.end=e}}class h{constructor(t,e={},r=[]){this.tag=t,this.attrs=e,this.children=r}translate(t=0,e=0){let r=new c(t,e);return this.children.push(r),this}rotate(t=0){let e=new l(t);return this.children.push(e),this}scale(t=1,e=1){let r=new u(t,e);return this.children.push(r),this}}class c extends h{constructor(t=0,e=0){super("translate",{x:t,y:e}),this.x=t,this.y=e}}class l extends h{constructor(t=0){super("rotate",{angle:-t}),this.angle=-t}}class u extends h{constructor(t=1,e=1){super("scale",{x:t,y:e}),this.x=t,this.y=e}}class d extends h{constructor(t,e){if(!(e instanceof h))return;let r=[];for(let s=0;s<t;s++){let t=new h(e.tag,e.attrs),s=e.children.map((t=>new h(t.tag,t.attrs)));r=r.concat([t,...s])}super(e.tag,e.attrs,r)}}function p(t,e,r,s,n,i=!1){const o=s+(t-e)*(n-s)/(r-e);return i?s<n?Math.min(Math.max(o,s),n):Math.min(Math.max(o,n),s):o}var f=function(t,e){var r={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(r[s]=t[s]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(t);n<s.length;n++)e.indexOf(s[n])<0&&Object.prototype.propertyIsEnumerable.call(t,s[n])&&(r[s[n]]=t[s[n]])}return r};class y{constructor(t){this.renderer=t}point(t={}){var{x:e=0,y:r=0}=t,n=f(t,["x","y"]);return new s(e,r,n)}circle(t={}){var{x:e=0,y:r=0,r:i=100}=t,o=f(t,["x","y","r"]);return new n(new s(e,r),i,o)}rectangle(t={}){var{x:e=0,y:r=0,w:n=200,h:i=100}=t,a=f(t,["x","y","w","h"]);return new o(new s(e,r),n,i,a)}ellipse(t={}){var{x:e=0,y:r=0,w:n=200,h:o=100}=t,a=f(t,["x","y","w","h"]);return new i(new s(e,r),n,o,a)}line(t={}){var{x1:e=-100,y1:r=0,x2:n=100,y2:i=0}=t,o=f(t,["x1","y1","x2","y2"]);return new a(new s(e,r),new s(n,i),o)}translate({x:t=0,y:e=0}={x:0,y:0}){return new c(t,e)}rotate({angle:t=0}={angle:0}){return new l(t)}scale({x:t=1,y:e=1}={x:1,y:1}){return new u(t,e)}repeat({n:t,transform:e,fnkwargs:r=null}){return new d(t,e)}}class w{constructor(t){this.renderer=t}show(t){}showTransform(t){}}class g extends w{constructor(t){super(t),this.renderer=window.self,this.renderer.translate(this.renderer.width/2,this.renderer.height/2),this.renderer.rectMode(this.renderer.CENTER),this.renderer.angleMode(this.renderer.DEGREES)}debug(t){console.log(t)}show(t){this.renderer.push(),t.transform.forEach((t=>this.showTransform(t)));for(const[e,r]of Object.entries(t.kwargs))this.renderer[e](r);this.renderer[t.tag](...Object.values(t.attrs)),t.children.forEach((t=>this.show(t))),this.renderer.pop()}showTransform(t){this.renderer[t.tag](...Object.values(t.attrs)),t.children.forEach((t=>{this.showTransform(t)}))}}class x extends w{constructor(t){super(t),this.namespace="http://www.w3.org/2000/svg",this.renderer=t}show(t){if(t instanceof s)return;const e=this.renderer.createElementNS(this.namespace,"svg");e.setAttribute("xmlns",this.namespace),e.setAttribute("width","100vw"),e.setAttribute("height","100vh");const r=this.getSvgElement(t);r.setAttribute("transform",`translate(-50%,-50%) ${r.getAttribute("transform")}`),e.appendChild(r),document.body.appendChild(e)}getSvgElement(t){console.log(t.children.length);const e=this.renderer.createElementNS(this.namespace,t.tag);for(const[r,s]of Object.entries(t.attrs))e.setAttribute(r,s.toString());for(const[r,s]of Object.entries(t.kwargs))e.setAttribute(r,s.toString());let r=t.transform.map((t=>`${t.tag}(${Object.values(t.attrs).join(",")}) ${t.children.map((t=>`${t.tag}(${Object.values(t.attrs).join(",")})`)).join(" ")}`)).join("");if(0!==t.children.length){console.log(t.children);let s=this.renderer.createElementNS(this.namespace,"g");s.setAttribute("transform",r),s.append(e);let n=t.children.map((t=>this.getSvgElement(t)));return s.append(...n),console.log(s),s}return e.setAttribute("transform",r),console.log(e),e}}function m(){return new y}return e})()));